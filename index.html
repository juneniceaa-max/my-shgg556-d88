<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“ä¸šç²¾åº¦æ˜Ÿç›˜ V3.0</title>
    <style>
        :root { --primary: #a29bfe; --gold: #ffeaa7; --bg: #0a0a12; }
        body { font-family: system-ui, sans-serif; background: var(--bg); color: white; margin: 0; display: flex; justify-content: center; padding: 20px; }
        .app-container { width: 100%; max-width: 500px; }
        .glass-card { 
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05)); 
            backdrop-filter: blur(20px); border-radius: 28px; padding: 30px; 
            border: 1px solid rgba(255,255,255,0.1); margin-bottom: 25px;
        }
        h1 { text-align: center; font-weight: 300; letter-spacing: 4px; color: var(--gold); }
        label { font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        input, select { 
            width: 100%; padding: 15px; margin: 8px 0 25px; 
            background: rgba(0,0,0,0.4); border: 1px solid #2d3436; 
            border-radius: 14px; color: white; font-size: 16px;
        }
        button { 
            width: 100%; padding: 18px; border-radius: 14px; border: none;
            background: #6c5ce7; color: white; font-weight: 600; cursor: pointer; transition: 0.4s;
        }
        button:hover { background: #a29bfe; transform: translateY(-3px); }
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .res-box { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 15px; border-top: 2px solid var(--primary); }
        .res-label { font-size: 11px; color: #aaa; margin-bottom: 5px; }
        .res-val { font-size: 18px; color: var(--gold); font-weight: bold; }
        .dynamic-report { 
            margin-top: 25px; padding: 20px; background: rgba(162, 155, 254, 0.05); 
            border-radius: 20px; font-size: 14px; line-height: 1.8; color: #eee;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <h1>STEL-ASTRO</h1>
        
        <div class="glass-card">
            <label>ğŸ“… Birth Date & Time</label>
            <input type="datetime-local" id="birthTime" value="1995-10-24T12:00">
            
            <label>ğŸ“ Location (Longitude)</label>
            <select id="citySelect">
                <option value="116.4">åŒ—äº¬ (Central China)</option>
                <option value="121.4">ä¸Šæµ· (East China)</option>
                <option value="113.2">å¹¿å· (South China)</option>
                <option value="104.0">æˆéƒ½ (West China)</option>
                <option value="120.1">æ­å· (Zhejiang)</option>
            </select>
            
            <button onclick="calculateHighPrecision()">æ¨æ¼”æ˜Ÿå‘½è½¨è¿¹</button>
        </div>

        <div id="resultArea" class="glass-card" style="display:none;">
            <div class="result-grid">
                <div class="res-box"><div class="res-label">å¤ªé˜³ SUN</div><div class="res-val" id="sun"></div></div>
                <div class="res-box"><div class="res-label">æœˆäº® MOON</div><div class="res-val" id="moon"></div></div>
                <div class="res-box"><div class="res-label">ä¸Šå‡ ASC</div><div class="res-val" id="asc"></div></div>
                <div class="res-box"><div class="res-label">é‡‘æ˜Ÿ VENUS</div><div class="res-val" id="venus"></div></div>
            </div>
            
            <div class="dynamic-report">
                <div id="reportHeader" style="color:var(--gold); margin-bottom:10px; font-weight:bold;"></div>
                <div id="reportContent"></div>
            </div>
        </div>
    </div>

    <script>
        function calculateHighPrecision() {
            const time = new Date(document.getElementById('birthTime').value);
            const lng = parseFloat(document.getElementById('citySelect').value);
            const signs = ["ç™½ç¾Š", "é‡‘ç‰›", "åŒå­", "å·¨èŸ¹", "ç‹®å­", "å¤„å¥³", "å¤©ç§¤", "å¤©è", "å°„æ‰‹", "æ‘©ç¾¯", "æ°´ç“¶", "åŒé±¼"];

            // 1. åŸºå‡†æ—¶é—´è®¡ç®— (è‡ª2000å¹´1æœˆ1æ—¥çš„æ€»å¤©æ•°)
            const epoch = new Date("2000-01-01T12:00:00Z");
            const d = (time - epoch) / 86400000;

            // 2. é«˜ç²¾åº¦å¤ªé˜³è®¡ç®— (å¤ªé˜³é»„ç» L)
            const L = (280.460 + 0.9856474 * d) % 360;
            const sunIdx = Math.floor(L / 30);

            // 3. é«˜ç²¾åº¦æœˆäº®è®¡ç®— (å‘¨æœŸ 27.321)
            const M = (125.04 - 1934.136 * (d/36525)) % 360; // ä¿®æ­£æœˆäº®äº¤ç‚¹
            const moonL = (218.316 + 13.176396 * d) % 360;
            const moonIdx = Math.floor((moonL < 0 ? moonL + 360 : moonL) / 30);

            // 4. ä¸Šå‡ç‚¹è®¡ç®— (æ’æ˜Ÿæ—¶ LST ä¿®æ­£)
            const hour = time.getHours() + time.getMinutes() / 60;
            const siderealTime = (100.46 + 0.985647 * d + lng + 15 * (hour - 8)) % 360;
            const ascIdx = Math.floor((siderealTime + 90) % 360 / 30);

            // 5. é‡‘æ˜Ÿè®¡ç®— (ä¼šåˆå‘¨æœŸä¿®æ­£)
            const venusL = (L + 1.60213 * d) % 360; // æ¨¡æ‹Ÿé‡‘æ˜Ÿç›¸å¯¹å¤ªé˜³çš„è¿è¡Œ
            const venusIdx = Math.floor((venusL < 0 ? venusL + 360 : venusL) / 30);

            // æ˜¾ç¤ºæ•°æ®
            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('sun').innerText = signs[sunIdx] + "åº§";
            document.getElementById('moon').innerText = signs[moonIdx] + "åº§";
            document.getElementById('asc').innerText = signs[ascIdx] + "åº§";
            document.getElementById('venus').innerText = signs[venusIdx] + "åº§";

            // åŠ¨æ€é€»è¾‘åˆ†æ
            document.getElementById('reportHeader').innerText = "âš–ï¸ å…ƒç´ å¹³è¡¡è§‚æµ‹";
            document.getElementById('reportContent').innerText = `åŸºäº J2000 å†å…ƒç®—æ³•ï¼Œä½ å½“å‰çš„å¤ªé˜³åº¦æ•°ä½äºé»„é“ç¬¬ ${Math.floor(L % 30)} åº¦ã€‚è¿™è¡¨æ˜ä½ çš„æ ¸å¿ƒèƒ½é‡å¤„äº ${signs[sunIdx]}åº§çš„æ·±å¤„ã€‚ä¸Šå‡ç‚¹æŒ‡å‘ ${signs[ascIdx]}åº§ï¼Œè¿™æ„å‘³ç€ä½ çš„äººç”Ÿå‰§æœ¬å°†ä»¥è¯¥æ˜Ÿåº§çš„ç‰¹è´¨ä½œä¸ºå¼€åœºã€‚`;
        }
    </script>
</body>
</html>