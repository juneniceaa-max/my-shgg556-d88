<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…¨ç»´å‘½ç†çŸ©é˜µ | ASTRO LAB</title>
    <style>
        :root {
            --primary: #7d5fff;
            --accent: #55efc4;
            --bg: #0c0d12;
            --card-bg: rgba(255, 255, 255, 0.05);
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: white;
            font-family: -apple-system, "SF Pro Text", "PingFang SC", system-ui, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 90%;
            max-width: 420px;
            margin: 0 auto;
            padding: 20px 0 40px 0;
        }

        .back-link {
            color: #888;
            text-decoration: none;
            font-size: 14px;
            display: inline-block;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 26px;
            text-align: center;
            background: linear-gradient(135deg, #a29bfe, #55efc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0 30px 0;
        }

        /* çŸ©é˜µç½‘æ ¼é€‚é… iPhone 12 */
        .matrix-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .matrix-item {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .item-label {
            font-size: 11px;
            color: #aaa;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .item-val {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent);
        }

        /* ç»¼åˆè§£æåŒºåŸŸä¼˜åŒ– */
        .synthesis-card {
            background: var(--card-bg);
            border-radius: 22px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .synthesis-title {
            font-size: 16px;
            color: #a29bfe;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }

        #synthesisText {
            font-size: 14px;
            line-height: 1.7;
            color: #ddd;
        }

        /* çµæ„ŸæŒ‡å¼•çš„è™šçº¿æ¡†æ ·å¼ */
        .insight-box {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed rgba(255, 255, 255, 0.15);
        }

        .insight-title {
            color: var(--accent);
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
        }

        /* æŠ½ç‰ŒåŒºåŸŸ */
        .tarot-area {
            text-align: center;
            padding: 20px;
            background: rgba(125, 95, 255, 0.08);
            border-radius: 24px;
        }

        #tarotEmoji { font-size: 40px; margin-bottom: 10px; display: block; }
        #tarotName { font-size: 18px; font-weight: bold; color: #fff; display: block; margin-bottom: 15px; }

        .draw-btn {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
            border: none;
            padding: 14px 40px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 8px 20px rgba(108, 92, 231, 0.3);
            cursor: pointer;
            transition: 0.3s;
        }

        .draw-btn:active { transform: scale(0.95); }

        .hint { font-size: 12px; color: #555; margin-top: 12px; }
    </style>
</head>
<body>

    <div class="container">
        <a href="index.html" class="back-link">â† è¿”å›å®éªŒå®¤</a>
        <h1>å…¨ç»´å‘½ç†çŸ©é˜µ</h1>

        <div class="matrix-grid">
            <div class="matrix-item">
                <span class="item-label">ğŸ§  MBTI æ˜ å°„</span>
                <span class="item-val" id="mbti">---</span>
            </div>
            <div class="matrix-item">
                <span class="item-label">ğŸ”¯ ç´«å¾®ä¸»æ˜Ÿ</span>
                <span class="item-val" id="ziwei">---</span>
            </div>
            <div class="matrix-item">
                <span class="item-label">ğŸ”¢ ä¹å‹äººæ ¼</span>
                <span class="item-val" id="enneagram">---</span>
            </div>
            <div class="matrix-item">
                <span class="item-label">ğŸƒ å¡”ç½—èƒ½é‡</span>
                <span class="item-val" id="tarotNameDisplay">---</span>
            </div>
        </div>

        <div class="synthesis-card">
            <div class="synthesis-title">ğŸŒŒ è·¨ç•Œç»¼åˆè§£æ</div>
            <div id="synthesisText">æ­£åœ¨åŒæ­¥å®‡å®™æ•°æ®...</div>
        </div>

        <div class="tarot-area">
            <span id="tarotEmoji">âœ¨</span>
            <span id="tarotName">å‡†å¤‡æ„Ÿåº”...</span>
            <button class="draw-btn" onclick="drawTarot()">é‡æ–°æŠ½ç‰Œ</button>
            <div class="hint">ç‚¹å‡»æŠ½å–æ­¤æ—¶æ­¤åˆ»çš„çµæ€§èƒ½æŒ‡å¼•</div>
        </div>
    </div>

    <script>
        const insights = [
            "å½“å‰çš„èƒ½é‡åœºæ˜¾ç¤ºï¼Œä½ éœ€è¦å¹³è¡¡æ„Ÿæ€§ä¸ç†æ€§çš„è¾¹ç•Œã€‚",
            "æ˜Ÿè±¡é¢„ç¤ºç€ä¸€ä¸ªéšè—çš„æœºé‡æ­£åœ¨ä½ çš„ç›´è§‰è¾¹ç¼˜æµ®ç°ã€‚",
            "ä½ å†…åœ¨çš„é˜²å¾¡æœºåˆ¶æ­£åœ¨æ¾åŠ¨ï¼Œè¿™æ˜¯æ¥çº³æ–°èƒ½é‡çš„æœ€å¥½æ—¶æœºã€‚",
            "ä¸å¿…æ€¥äºåšå‡ºå†³å®šï¼Œæ­¤æ—¶æ­¤åˆ»ï¼Œé™è§‚å…¶å˜æ˜¯æœ€å¥½çš„ç­–ç•¥ã€‚",
            "æŸä¸ªè¿‡å»è¢«ä½ å¿½ç•¥çš„ä¿¡å·ï¼Œå°†åœ¨æœªæ¥48å°æ—¶å†…é‡æ–°å‡ºç°ã€‚",
            "åœ¨å¤æ‚çš„å±€é¢ä¸­ï¼Œä¿æŒâ€˜åˆ©ä»–â€™çš„å¿ƒæ€ä¼šè®©ä½ è·å¾—æ„å¤–çš„ä¿æŠ¤ã€‚",
            "ä½ æ­£åœ¨å¸å¼•ä¸ä½ èƒ½é‡é¢‘ç‡ç›¸åŒçš„äººï¼Œé«˜è´¨é‡çš„ç¤¾äº¤å³å°†åˆ°æ¥ã€‚",
            "æ—§çš„å¾ªç¯å³å°†ç»“æŸï¼Œè¯·åšå¥½æ¸…ç†ï¼Œè¿æ¥å…¨æ–°çš„èº«ä»½è®¤åŒã€‚"
        ];

        const cards = [
            { e: "â˜€ï¸", n: "å¤ªé˜³", d: "æˆåŠŸä¸æ¸…æ™°" },
            { e: "ğŸ¡", n: "å‘½è¿ä¹‹è½®", d: "é‡å¤§çš„è½¬æŠ˜" },
            { e: "ğŸ§˜", n: "éšå£«", d: "å†…çœçš„æ™ºæ…§" },
            { e: "ğŸŒŸ", n: "æ˜Ÿæ˜Ÿ", d: "å¸Œæœ›ä¸æ²»æ„ˆ" },
            { e: "ğŸ­", n: "é­”æœ¯å¸ˆ", d: "åˆ›é€ ä¸æ½œèƒ½" }
        ];

        function renderMatrix() {
            const userAstro = JSON.parse(localStorage.getItem('userAstro'));
            if (!userAstro) {
                window.location.href = 'index.html';
                return;
            }

            // æ€§åº§æ€§æ ¼æ˜ å°„é€»è¾‘
            const mbtiMap = { "å¤©è": "INTJ", "å¤©ç§¤": "ENFJ", "å¤„å¥³": "ISTJ", "ç‹®å­": "ENTP" };
            const ziweiMap = { "å¤©ç§¤": "å¤©åŒå¤ªé˜´", "å¤©è": "å»‰è´ä¸ƒæ€", "å¤„å¥³": "ç´«å¾®å¤©åºœ" };
            
            const mbti = mbtiMap[userAstro.sun] || "INFJ";
            const ziwei = ziweiMap[userAstro.asc] || "ç ´å†›åŒ–ç¦„";
            
            document.getElementById('mbti').innerText = mbti;
            document.getElementById('ziwei').innerText = ziwei;
            document.getElementById('enneagram').innerText = (mbti === "INTJ") ? "5w6 è§‚å¯Ÿè€…" : "4w5 è‰ºæœ¯å‹";

            // ğŸš© åˆå§‹åŒ–åŠ è½½ï¼šè‡ªåŠ¨è§¦å‘ä¸€æ¬¡æŠ½ç‰Œ
            drawTarot();
        }

        function drawTarot() {
            const userAstro = JSON.parse(localStorage.getItem('userAstro'));
            const mbti = document.getElementById('mbti').innerText;
            const ziwei = document.getElementById('ziwei').innerText;

            const randomCard = cards[Math.floor(Math.random() * cards.length)];
            const randomInsight = insights[Math.floor(Math.random() * insights.length)];

            // æ›´æ–°ç•Œé¢
            document.getElementById('tarotEmoji').innerText = randomCard.e;
            document.getElementById('tarotName').innerText = randomCard.n;
            document.getElementById('tarotNameDisplay').innerText = randomCard.n;

            // åŠ¨æ€ç”Ÿæˆå¸¦æ ·å¼çš„ HTML
            document.getElementById('synthesisText').innerHTML = `
                åŸºäº<b>${userAstro.sun}åº§</b>ä¸<b>${mbti}</b>çš„äº¤å‰å½±å“ï¼Œä½ çš„æ€§æ ¼åº•å±‚é€»è¾‘éå¸¸ç¨³å›ºã€‚
                é…åˆç´«å¾®å‘½ç›˜ä¸­çš„<b>${ziwei}</b>ï¼Œä½ è¿‘æœŸçš„èƒ½é‡æµå‘æ­£å¤„äºè°ƒæ•´æœŸã€‚
                <div class="insight-box">
                    <span class="insight-title">ğŸ”® æ­¤æ—¶æ­¤åˆ»çš„çµæ„ŸæŒ‡å¼•ï¼š</span>
                    ${randomInsight}
                </div>
            `;
        }

        // é¡µé¢åŠ è½½å³è¿è¡Œ
        window.onload = renderMatrix;
    </script>
</body>
</html>